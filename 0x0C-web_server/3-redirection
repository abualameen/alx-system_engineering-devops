#!/usr/bin/env bash
# Script to install Nginx and display content of HTML

# Update and install Nginx
sudo apt-get -y update
sudo apt-get install -y nginx

# Modify the default Nginx server block
sudo sed -i 's/listen 80 default_server;/listen 80;/' /etc/nginx/sites-available/default

# Create an HTML file with a Hello World message
echo '<!DOCTYPE html>
<html>
<head>
    <title>Hello World!</title>
</head>
<body>
    <h1>Hello World!</h1>
</body>
</html>' | sudo tee /var/www/html/index.html

# Create a new server block for /redirect_me
sudo cat > /etc/nginx/sites-available/redirect_me << EOF
server {
    listen 80;
    listen [::]:80;

    server_name _;

    location / {
        return 200 "This is the output of the first task\n";
    }

    location /redirect_me {
        return 301 https://www.youtube.com/watch?v=WVDFREI8J3w;
    }
}
EOF

# Create symbolic links and restart Nginx
if [ -f /etc/nginx/sites-enabled/redirect_me ]; then
    echo "Removing existing configuration file..."
    sudo rm /etc/nginx/sites-enabled/redirect_me
fi

sudo ln -sf /etc/nginx/sites-available/default /etc/nginx/sites-enabled/
sudo ln -sf /etc/nginx/sites-available/redirect_me /etc/nginx/sites-enabled/
sudo service nginx restart

echo "Nginx configured for redirection."

