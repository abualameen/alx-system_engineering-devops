#!/usr/bin/env bash

# This script generates a tar-gzipped archive of the MySQL backup file.

# Get the current date in the desired format: dd-mm-yyyy
CURRENT_DATE=$(date +"%d-%m-%Y")

# Define the filename with the desired format
FILENAME="${CURRENT_DATE}.tar.gz"

# Dump all MySQL databases to backup.sql
mysqldump -u root -p"$1" --all-databases > backup.sql

# Check if the mysqldump command was successful
if [ $? -ne 0 ]; then
    echo "Error: MySQL dump failed!"
    exit 1
fi

# Compress the backup.sql file into a tar-gzipped archive
tar -czvf "$FILENAME" backup.sql

# Check if the tar command was successful
if [ $? -ne 0 ]; then
    echo "Error: Compression failed!"
    exit 1
fi

# Print success message
echo "MySQL backup completed successfully!"
